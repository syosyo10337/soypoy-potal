#!/bin/bash

# nodeã‚³ãƒãƒ³ãƒ‰ã‚’docker composeçµŒç”±ã§å®Ÿè¡Œã™ã‚‹ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# ä½¿ç”¨æ–¹æ³•: ./bin/node -v
#          ./bin/node script.js
#

# ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
CONTAINER_RUNNING=$(docker compose ps --status running --services | grep app || true)

if [ -z "$CONTAINER_RUNNING" ]; then
  echo "â„¹ï¸  é–‹ç™ºã‚³ãƒ³ãƒ†ãƒŠãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ä¸€æ™‚çš„ãªã‚³ãƒ³ãƒ†ãƒŠã§å®Ÿè¡Œã—ã¾ã™..."
  echo "ğŸ”„ 'node $@' ã‚’å®Ÿè¡Œä¸­..."
  docker compose run --rm app node "$@"
else
  echo "ğŸ”„ é–‹ç™ºã‚³ãƒ³ãƒ†ãƒŠå†…ã§ 'node $@' ã‚’å®Ÿè¡Œä¸­..."
  docker compose exec app node "$@"
fi
